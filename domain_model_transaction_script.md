## 블로그 정리 글 
아래 블로그를 정리한 글.
https://velog.io/@hoyun7443/%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%ED%8C%A8%ED%84%B4-vs-%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%AA%A8%EB%8D%B8-%ED%8C%A8%ED%84%B4

## 도메인 모델 패턴

- 도메인 모델은 도메인(비즈니스 영역)의 모델을 생성하는 패턴이다. 도메인 모델은 비즈니스 영역에서 사용되는 객체를 판별하고, 객체가 제공해야 할 목록을 추출하며, 각 객체간의 관계를 정립시키는 과정을 거친다.
- 명사와 동사를 구분해서 명사로부터 객체를 추출하고, 동사로부터 객체의 기능과 관계를 유추한다.
- 객체를 기반으로 하는 도메인 모델은 "데이터와 프로세스가 혼합" 되어있다는 특징이 있고, 객체 간 복잡한 연관관계를 가지고 있으며 상속 등을 통해 객체의 기능과 역할을 확장해나갈 수 있다.

```
<%
        ...
        try {
        
            SomeTransaction tx = ...;
            tx.begin();
            ...
            DB에 데이터 기록
            ...
            tx.commit();
            
            // 성공하면 이메일 발송
            ...
            
        } catch(..) {
            tx.rollback();
            ...
        } finally {
            ...
            ...
        }
    %>
```

## 도메인 모델의 장단점

- 도메인 모델의 장점은 객체지향에 기반한 재사용성, 확장성, 유지보수의 편리성이 있다.
- 예를 들어, 커뮤니티 (게시판, 클럽) 도메인 모델을 구축하면 비슷한 커뮤니티 시스템에서 도메인 모델을 제사용할 수 있다.
- 도메인 모델의 단점은 하나의 모델을 구축하는 데 많은 노력이 든다는 것이다.
- 객체를 판별하고, 관계를 정립하고, 데이터베이스 사이의 매핑에 대해 고민해야하기 때문이다.

## 트랜잭션 스크립트 패턴

- 은행의 계좌 이체 서비스를 생각해보면, "잔고 확인 => 받는 사람 확인 => 이체 => 잔고 감소" 가 하나의 로직으로 처리돼야 하고, 여기서 한번이라도 오류가 발생하면 모든 처리가 취소된다.
- 트랜잭션 스크립트 패턴은 이렇게 하나의 트랜잭션으로 구성된 로직을 단일함수/단일스크립트에서 처리하는 구조이다.

```
   public class SomeTransactionScript {
        public Result do(...) {
            try {
            
                SomeTransaction tx = ...;
                tx.begin();
                
                // 1. 잔고확인
                ...
                // 2. 받는 사람 확인
                ...
                // 3. 이체 실행
                ...
                // 4. 잔고 감소
                ...
                tx.commit();
                
            } catch(..) {
                tx.rollback();
                ...
            } finally {
                ...
                ...
            }
        }
    }
```

## 트랜잭션 스크립트 장단점

- 구현이 쉽다.
- 그러나 비즈나스 로직이 복잡해질수록 복잡하고 중복 코드 발생을 막기 어려워진다. (애초에 도메인 분석/설계 개념을 약하게 만들기 때문)
- 또한 트랜잭션 스크립트를 사용하게 되면 쉬운 개발에 익숙해지기 때문에 공통 코드를 공통 모듈로 분리하지 않고 중복 코드를 만드는 유혹에 빠지기 쉽다. 😱
